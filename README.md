# Nikke 数字消除辅助工具

一个专为Nikke游戏设计的数字消除辅助工具，基于深度学习和优化算法，能够自动识别游戏界面并进行智能求解。

## 功能特性

### 🎯 核心功能
- **智能数字识别**: 使用CNN深度学习模型自动识别游戏中的数字
- **高效求解算法**: 基于Beam Search和Numba加速的优化求解器
- **自动化操作**: 自动执行点击操作，完成数字消除
- **透视变换**: 支持游戏界面的透视矫正，支持原生高DPI缩放
- **热键支持**: 可自定义快捷键操作

### 🚀 技术亮点
- **CNN数字识别**: 使用PyTorch构建的卷积神经网络模型
- **Numba加速**: 核心算法使用Numba JIT编译，性能提升10-100倍
- **智能提前终止**: 多重退出条件，避免无效计算
- **优化Beam Search**: 动态算力调整 + 连续无改进检测
- **Smart Rollback**: 智能回溯策略，激进的残局处理
- **启发式评估**: 孤岛惩罚 + 中心引力 + 动态噪音
- **三种求解模式**: classic（保守）、omni（激进）、god（综合，推荐）

## 技术架构

### 图像处理模块 (`core/image_processor.py`)
- 屏幕区域截取
- 透视变换和网格分割
- 图像预处理和增强

### CNN识别器 (`core/cnn_recognizer.py`)
- 基于PyTorch的卷积神经网络
- 支持0-9数字识别
- 实时图像推理

### 游戏求解器 (`core/game_solver.py`)
- **核心算法来源**: [sum10_Nikke](https://github.com/Small-tailqwq/sum10_Nikke)
- Numba加速的Beam Search算法
- 智能回滚策略（Smart Rollback）
- 单线程优化实现

### 自动化控制 (`core/automation.py`)
- 鼠标点击自动化
- 精确坐标映射
- 操作延迟控制

## 算法与模型来源

**重要声明**: 本项目中的核心算法和深度学习模型来源于 [sum10_Nikke](https://github.com/Small-tailqwq/sum10_Nikke) 项目。

- **游戏求解算法**: 基于原项目的Beam Search优化算法
- **CNN识别模型**: 使用原项目训练的digit识别模型
- **性能优化**: 继承并优化了Numba加速策略

感谢 [Small-tailqwq](https://github.com/Small-tailqwq) 的开源贡献！

## 环境要求

- Python 3.8+
- Windows 10/11 (需要管理员权限)

## 安装依赖

```bash
pip install -r requirements.txt
```

## 使用说明

### 1. 启动程序
```bash
python main.py
```

### 2. 首次运行
程序会自动请求管理员权限，这是为了能够进行屏幕截取和自动化操作。

### 3. 设置快捷键
- 启动后在设置对话框中配置个人喜好的快捷键
- 默认快捷键可在GUI界面中查看和修改

### 4. 开始使用
1. 点击"截取区域"按钮，选择游戏中的数字网格区域
2. 程序会自动识别数字并显示在界面上
3. 点击"开始求解"获得最优解
4. 点击"自动执行"让程序自动完成操作

## 核心依赖

- **深度学习**: PyTorch, TorchVision
- **图像处理**: OpenCV, Pillow, NumPy
- **性能加速**: Numba, llvmlite
- **自动化**: PyDirectInput, Keyboard
- **界面**: Tkinter, SV-TTK (Sun Valley主题)

## 性能优化

- **Numba JIT编译**: 核心计算函数编译为机器码，速度提升10-100倍
- **前缀和优化**: O(1)时间复杂度查询矩形区域和
- **智能提前终止**: 连续20步无改进自动停止，避免无效计算
- **动态算力调整**: 残局×3算力，中局×1.5算力
- **内存友好**: 减少内存复制，提升缓存命中率

## 注意事项

1. **管理员权限**: 程序需要管理员权限才能正常运行
2. **游戏窗口**: 确保游戏窗口在前台且可见
3. **屏幕缩放**: 建议使用100%缩放比例以获得最佳识别效果
4. **性能要求**: 建议使用性能较好的电脑以保证实时性
5. **算法性能**: 单线程实现已达极致，无需并行优化

## 分发说明

**本项目不提供任何形式的分发文件或打包版本**。用户需要自行从源代码构建和安装。

## 许可证

本项目仅供学习和研究使用，请遵守相关游戏的使用条款。
